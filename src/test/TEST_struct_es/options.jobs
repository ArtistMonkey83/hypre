#!/bin/sh 
#BHEADER***********************************************************************
# (c) 1998   The Regents of the University of California
#
# See the file COPYRIGHT_and_DISCLAIMER for a complete copyright
# notice, contact person, and disclaimer.
#
# $Revision: 1.1 $
#EHEADER***********************************************************************

#=============================================================================
# ij driver for eigenvalue solvers: (without -lobpcg option runs ij) 
# This script tests LOBPCG input options and defaults 
#===========================================================================

# all defaults
mpirun -np 2 ./struct_es  -lobpcg > options.out.default 

# -solver none : no HYPRE preconditioner is used  (default -solver 10)
mpirun -np 2 ./struct_es  -lobpcg -solver none  >  options.out.solver.none 

# -itr <val>   : maximal number of LOBPCG iterations (default 100)
mpirun -np 2 ./struct_es  -lobpcg -n 15 15 16 -vrand 2 -solver 18 -seed 1 > options.out.itr.100
# 2 iterations maximum
mpirun -np 2 ./struct_es  -lobpcg -n 15 15 16 -vrand 2 -solver 18 -seed 1 -itr 2 > options.out.itr.2

# -vrand 2 : compute 2 eigenpairs using random initial vectors (default 1)
mpirun -np 2 ./struct_es -lobpcg -vrand 2 > options.out.vrand.2

# -seed 1  : use 1 as the seed for the pseudo-random number generator
#            (default seed is based on the time of the run)
# The output files below should be identical, but different from options.out.default
mpirun -np 2 ./struct_es -lobpcg -seed 1 > options.out.seed
mpirun -np 2 ./struct_es -lobpcg -seed 1 > options.out.seed.repeat

# no orthonormality check
mpirun -np 2 ./struct_es  -lobpcg -seed 1 > options.out.no_orthchk
# -orthchk : check eigenvectors for orthonormality  
mpirun -np 2 ./struct_es  -lobpcg -seed 1 -orthchk  > options.out.orthchk

# -verb <val> : verbosity level
# -verb 0  : no print
mpirun -np 2 ./struct_es  -lobpcg -seed 1 -verb 0 > options.out.verb.0
# -verb 1  : print initial eigenvalues and residuals, iteration number, number of
#            non-convergent eigenpairs and final eigenvalues and residuals (default)
mpirun -np 2 ./struct_es  -lobpcg -seed 1  > options.out.verb.1
# -verb 2  : print eigenvalues and residuals on each iteration
mpirun -np 2 ./struct_es  -lobpcg -seed 1 -verb 2 > options.out.verb.2

# -pcgitr <val>: maximal number of inner PCG iterations for preconditioning (default 1);
# -pcgitr 0 : the preconditioner is applied directly
mpirun -np 2 ./struct_es  -lobpcg -seed 1 -pcgitr 0 > options.out.pcgitr.0
# default number of inner iterations (1)
mpirun -np 2 ./struct_es  -lobpcg -seed 1  > options.out.pcgitr.1
# -pcgitr 2 : two inner iterations
mpirun -np 2 ./struct_es  -lobpcg -seed 1 -pcgitr 2 > options.out.pcgitr.2

# -pcgtol <val> : residual tolerance for inner iterations (default 0.01)
mpirun -np 2 ./struct_es  -lobpcg -solver 18 -seed 1 -pcgitr 1000 > options.out.pcgtol.01
# -pcgtol 0.05
mpirun -np 2 ./struct_es  -lobpcg -solver 18 -seed 1 -pcgitr 1000 -pcgtol 0.05 > options.out.pcgtol.05
