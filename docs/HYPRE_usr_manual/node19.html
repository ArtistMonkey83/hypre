<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!--Converted with LaTeX2HTML 96.1-g (June 11, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>4.4 Setting Up the SStruct Matrix</TITLE>
<META NAME="description" CONTENT="4.4 Setting Up the SStruct Matrix">
<META NAME="keywords" CONTENT="usr_manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL=STYLESHEET HREF="usr_manual.css">
</HEAD>
<BODY LANG="EN" >
 <A NAME="tex2html333" HREF="node20.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="http://cbl.leeds.ac.uk/nikos/figs/next_motif.gif"></A> <A NAME="tex2html331" HREF="node15.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="http://cbl.leeds.ac.uk/nikos/figs/up_motif.gif"></A> <A NAME="tex2html325" HREF="node18.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="http://cbl.leeds.ac.uk/nikos/figs/previous_motif.gif"></A> <A NAME="tex2html335" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="http://cbl.leeds.ac.uk/nikos/figs/contents_motif.gif"></A> <A NAME="tex2html336" HREF="node40.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="http://cbl.leeds.ac.uk/nikos/figs/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html334" HREF="node20.html">4.5 Setting Up the </A>
<B>Up:</B> <A NAME="tex2html332" HREF="node15.html">4 Semi-Structured-Grid System Interface </A>
<B> Previous:</B> <A NAME="tex2html326" HREF="node18.html">4.3 Setting Up the </A>
<BR> <P>
<H1><A NAME="SECTION00540000000000000000">4.4 Setting Up the SStruct Matrix</A></H1>
<P>
<A NAME="SettingUptheSStructMatrix">&#160;</A>
<P>
The matrix is set up in terms of the graph object described in Section
<A HREF="node18.html#SettingUptheSStructGraph">4.3</A> above.  The coefficients associated
with each graph entry will typically vary from gridpoint to gridpoint,
but in the example problem being considered, they are as follows over
the entire grid (except at boundaries; see below):
<P><A NAME="sstructeqnstencillaplacian">&#160;</A> <IMG WIDTH=500 HEIGHT=68 ALIGN=BOTTOM  SRC="img12.gif"  > <P>
<P>
On process 0, the following code will set up matrix values associated
with the center ( <IMG WIDTH=16 HEIGHT=25 ALIGN=MIDDLE  SRC="img5.gif"  > ) and south ( <IMG WIDTH=16 HEIGHT=25 ALIGN=MIDDLE  SRC="img6.gif"  > ) stencil entries in
(<A HREF="node11.html#eqnstencildescription">3.2</A>) / (<A HREF="node12.html#eqnstencillaplacian">3.3</A>).
Matrix values associated with the non-stencil graph entries are also
set up.
<blockquote><PRE>HYPRE_SStructMatrix  A;
double               values[32];
int                  sindices[2] = {0,3};
int                  gindices[4] = {9,10,11,0};
int                  i;

HYPRE_SStructMatrixCreate(MPI_COMM_WORLD, graph, &amp;A);
HYPRE_SStructMatrixInitialize(A);

for (i = 0; i &lt; 32; i += 2)
{
   values[i]   =  8.0;
   values[i+1] = -1.0;
}
HYPRE_SStructMatrixSetBoxValues(A, 0, ilower[0], iupper[0], 0,
                                2, sindices, values);

/* set values at non-stencil graph entries */
for (i = 0; i &lt; 3; i++)
{
   values[i] = -1.0;
}
HYPRE_SStructMatrixSetValues(A, 0, addindex[0], 0, 2, gindices, values);
HYPRE_SStructMatrixSetValues(A, 0, addindex[1], 0, 3, gindices, values);
HYPRE_SStructMatrixSetValues(A, 0, addindex[2], 0, 3, gindices, values);
...
HYPRE_SStructMatrixSetValues(A, 0, addindex[7], 0, 1, gindices, values);
HYPRE_SStructMatrixSetValues(A, 0, addindex[7], 1, 1, &amp;gindices[3], values);

/* zero out coefficients that reach outside of the domain or grid part */
...

/* set boundary conditions at domain boundaries, */
...

HYPRE_SStructMatrixAssemble(A);</PRE>
</blockquote><HR><A NAME="tex2html333" HREF="node20.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="http://cbl.leeds.ac.uk/nikos/figs/next_motif.gif"></A> <A NAME="tex2html331" HREF="node15.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="http://cbl.leeds.ac.uk/nikos/figs/up_motif.gif"></A> <A NAME="tex2html325" HREF="node18.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="http://cbl.leeds.ac.uk/nikos/figs/previous_motif.gif"></A> <A NAME="tex2html335" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="http://cbl.leeds.ac.uk/nikos/figs/contents_motif.gif"></A> <A NAME="tex2html336" HREF="node40.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="http://cbl.leeds.ac.uk/nikos/figs/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html334" HREF="node20.html">4.5 Setting Up the </A>
<B>Up:</B> <A NAME="tex2html332" HREF="node15.html">4 Semi-Structured-Grid System Interface </A>
<B> Previous:</B> <A NAME="tex2html326" HREF="node18.html">4.3 Setting Up the </A>
<P><ADDRESS>
<I>Thomas Treadway <BR>
Fri Jul 27 10:01:25 PDT 2001</I>
</ADDRESS>
</BODY>
</HTML>
